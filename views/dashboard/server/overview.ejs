<%- include('../../components/head') %>

<body class="min-h-screen bg-neutral-950 text-slate-100">
  <%- include('../../components/modal') %>
  <div>
    <%- include('../../components/navigation') %>
    <div class="md:pl-64 flex flex-col flex-1 min-h-screen">
      <%- include('../../components/header') %>
      <main class="flex-1 pb-8">
        <div class="py-4 md:py-6">
          <% /* Skeleton loader, lasts about 0.3s to let the page content load */ %>
          <%- include('../../components/skeleton') %>
          <div class="hidden max-w-screen-2xl mx-auto px-4 sm:px-6 md:px-8" id="content">
            <%- include('./header') %>

            <%- include('./tabs') %>

            <div class="grid grid-cols-1 xl:grid-cols-[2fr_1fr] gap-6 mt-6">
              <div class="bg-neutral-900/60 rounded-2xl border border-neutral-800/80 p-6 space-y-6">
                <div class="flex items-center justify-between">
                  <div>
                    <p class="text-xs uppercase tracking-[0.3em] text-slate-500">Resources</p>
                    <h2 class="text-xl font-semibold text-white mt-1">Server limits</h2>
                  </div>
                  <span class="text-xs text-slate-500">
                    <%= (server.attributes.feature_limits && server.attributes.feature_limits.backups) ? server.attributes.feature_limits.backups + " backups" : "Backups not capped" %>
                  </span>
                </div>
                <div class="grid grid-cols-1 md:grid-cols-3 gap-4 text-sm">
                  <div class="rounded-2xl bg-neutral-950/70 border border-neutral-800/70 p-4 space-y-1">
                    <div class="text-xs uppercase tracking-[0.3em] text-slate-500">CPU</div>
                    <div class="text-xl font-semibold text-white">
                      <%= server.attributes.limits && server.attributes.limits.cpu
                        ? (server.attributes.limits.cpu / 100).toFixed(2)
                        : "0" %> cores
                    </div>
                    <p class="text-xs text-slate-500">Allowed</p>
                  </div>
                  <div class="rounded-2xl bg-neutral-950/70 border border-neutral-800/70 p-4 space-y-1">
                    <div class="text-xs uppercase tracking-[0.3em] text-slate-500">Memory</div>
                    <div class="text-xl font-semibold text-white">
                      <%= server.attributes.limits && server.attributes.limits.memory
                        ? (server.attributes.limits.memory / 1024).toFixed(2)
                        : "0" %> GB
                    </div>
                    <p class="text-xs text-slate-500">Total</p>
                  </div>
                  <div class="rounded-2xl bg-neutral-950/70 border border-neutral-800/70 p-4 space-y-1">
                    <div class="text-xs uppercase tracking-[0.3em] text-slate-500">Disk</div>
                    <div class="text-xl font-semibold text-white">
                      <%= server.attributes.limits && server.attributes.limits.disk
                        ? (server.attributes.limits.disk / 1024).toFixed(2)
                        : "0" %> GB
                    </div>
                    <p class="text-xs text-slate-500">Total</p>
                  </div>
                </div>
                <div class="rounded-2xl bg-neutral-950/70 border border-neutral-800/70 p-4 space-y-1">
                  <div class="text-xs uppercase tracking-[0.3em] text-slate-500">Allocations</div>
                  <div class="flex flex-wrap gap-2 mt-2 text-sm">
                    <% const allocations = server.relationships && server.relationships.allocations && server.relationships.allocations.data ? server.relationships.allocations.data : []; %>
                    <% if (allocations.length === 0) { %>
                      <span class="text-slate-500">No allocations were returned.</span>
                    <% } else { %>
                      <% allocations.forEach(function (allocation) { %>
                        <span class="rounded-full bg-neutral-900 px-3 py-1 text-slate-300 text-xs border border-neutral-800">
                          <%= allocation.attributes.ip %>:<%= allocation.attributes.port %>
                        </span>
                      <% }) %>
                    <% } %>
                  </div>
                </div>
              </div>

              <div class="bg-neutral-900/60 rounded-2xl border border-neutral-800/80 p-6 space-y-4">
                <div>
                  <p class="text-xs uppercase tracking-[0.3em] text-slate-500">Quick actions</p>
                  <h2 class="text-xl font-semibold text-white">Jump right in</h2>
                </div>
                <div class="space-y-2">
                  <a
                    href="<%= serverConsoleUrl %>"
                    target="_blank"
                    rel="noreferrer"
                    class="block rounded-2xl border border-neutral-800/70 bg-white/5 px-4 py-3 text-sm font-semibold text-white hover:bg-white/10 transition"
                  >
                    View live console
                  </a>
                  <a
                    href="/servers"
                    class="block rounded-2xl border border-neutral-800/70 bg-neutral-900/70 px-4 py-3 text-sm font-semibold text-slate-300 hover:border-slate-500 transition"
                  >
                    Manage server listings
                  </a>
                  <a
                    href="/dashboard/server/<%= server.attributes.id %>/files"
                    class="block rounded-2xl border border-neutral-800/70 bg-neutral-900/70 px-4 py-3 text-sm font-semibold text-slate-300 hover:border-slate-500 transition"
                  >
                    Browse files & schedules
                  </a>
                </div>
              </div>
            </div>
          </div>
        </div>
      </main>
      <%- include('../../components/footer') %>
    </div>
  </div>
  <%- include('../../components/notifications') %>
</body>
